\documentclass[12pt]{article}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage[english,russian]{babel}
\usepackage{fullpage}
\usepackage[utf8]{inputenc}
\usepackage{hyperref}
\usepackage{ccfonts}
\usepackage[T1]{fontenc}

\renewcommand{\bfdefault}{sbc}

\newcommand{\eps}{\varepsilon}
\newcommand{\Rc}{\mathcal{R}}
\newcommand{\dunw}{d_{\mathrm{unw}}}
\newcommand{\set}[1]{\left\{#1\right\}}
\newcommand{\abs}[1]{\left|#1\right|}
\newcommand{\zo}{\set{0, 1}}
\newcommand{\Oc}{\mathcal{O}}
\newcommand{\Pc}{\mathcal{P}}
\newcommand{\Exp}[2]{\mathbf{E}_{#1}\left[#2\right]}
\newcommand{\setst}[2]{\set{#1 \mid #2}}

\newcommand*{\glue}{\nobreak\hskip 0pt}
\DeclareRobustCommand*{\dd}{\glue\hbox{-}\glue}
\DeclareRobustCommand*{\DD}{\glue\hbox{-}\hskip 0pt}
\DeclareRobustCommand*{\cc}{\,\textendash\,\glue}
\DeclareRobustCommand*{\CC}{\,\textendash\,\hskip 0pt}
\DeclareRobustCommand*{\tt}{~\textemdash{} }
\DeclareRobustCommand*{\TT}{~\textemdash{} }

\newtheorem{definition}{Определение}
\newtheorem{problem}{Задача}
\newtheorem{theorem}{Теорема}
\newtheorem{lemma}{Лемма}

\begin{document}
    \thispagestyle{empty}
    \begin{center}
        Московский государственный университет имени
        М.В. Ломоносова\\
        механико-математический факультет\\
        кафедра математической логики и теории алгоритмов
    \end{center}
    \vspace{2cm}
    \begin{center}
        {\Large Дипломная работа}\\
        студента 507 группы
        Разенштейна Ильи
    \end{center}
    \vspace{1cm}
    \begin{center}
        {\Large Покрытия кратчайших путей в ненаправленных графах}
    \end{center}
    \vspace{3cm}
    \begin{flushright}
        Научный руководитель: к.ф.-м.н. М.А. Бабенко\\
        Рецензент: ??? \\
    \end{flushright}
    \vspace{\fill}
    \begin{center}
        Москва\\2012
    \end{center}
    \pagebreak
    \tableofcontents
    \section{Введение}
    \subsection{Постановка задач}
    Пусть $G = (V, E, w)$~--- взвешенный ненаправленный граф с неотрицательными весами на ребрах.
    Граф $G$ порождает две метрики на вершинах: обозначим $d(v_1, v_2)$ кратчайшее расстояние между вершинами $v_1$
    и $v_2$, а $\dunw(v_1, v_2)$~--- кратчайшее расстояние в невзвешенной версии $G$.

    Поставим две задачи.
    \begin{problem}[Задача об $\eps$-покрытиях]
        Пусть $\eps > 0$~--- положительный параметр. Назовем множество вершин $N \subseteq V$ \emph{$\eps$-покрытием},
        если для любых вершин $v_1, v_2 \in V$ таких, что $\dunw(v_1, v_2) \geq \eps n$, найдется вершина $u \in N$
        такая, что $d(v_1, v_2) = d(v_1, u) + d(u, v_2)$.

        Каков минимальный размер $\eps$-покрытия графа $G$?
    \end{problem}
    \begin{problem}[Задача о системах пересадок]
        Назовем отображение $L \colon V \to 2^V$ \emph{системой пересадок}, если для любых вершин $v_1, v_2 \in V$
        найдется вершина $u \in L(v_1) \cap L(v_2)$ такая, что $d(v_1, v_2) = d(v_1, u) + d(u, v_2)$.
        \emph{Размером} системы пересадок $L$ назовем величину $\sum_{v \in V} \abs{L(v)}$. 

        Каков минимальный размер системы пересадок графа $G$?
    \end{problem}
    \subsection{Задача об $\eps$-покрытиях}
    В разделе~\ref{section_eps_covers} мы изучаем задачу об $\eps$-покрытиях.
    В разделе~\ref{subsection_general_graphs} с помощью теории размерности Вапника\CC Червоненкиса~\cite{VC71}
    мы доказываем существование $\eps$-покрытий размера $O(\log(1 / \eps) / \eps)$.
    Мы используем наблюдение из~\cite{ADFGW11}: система уникальных кратчайших путей имеет маленькую размерность
    Вапника\CC Червоненкиса.
    Также мы доказываем сверхлинейную нижнюю оценку $\omega(1 / \eps)$ на размер $\eps$-покрытия.
    Для этого мы используем плотностную версию теоремы Хейлса\CC Джуетта~\cite{P09} из аддитивной комбинаторики.
    Отметим, что в статье~\cite{A10} применяется такая же техника для похожей комбинаторной задачи.
    Далее в разделе~\ref{subsection_bounded_treewidth} мы доказываем линейную верхнюю оценку $O(1 / \eps)$
    на размер $\eps$-покрытия в графах ограниченной древесной ширины.

    Далее в разделе~\ref{subsection_applications} мы описываем два приложения маленьких $\eps$-покрытий.
    \subsubsection{Оракул больших расстояний}
    Пусть $G = (V, E)$~--- ненаправленный \emph{невзвешенный} граф.
    Мы хотим построить структуру данных, которая по паре вершин $v_1, v_2 \in V$ сообщает одно из двух:
    если $d(v_1, v_2) < \eps n$, то структура должна сообщить об ошибке, если же $d(v_1, v_2) \geq \eps n$,
    то структура должна сообщить точное значение $d(v_1, v_2)$.

    В разделе~\ref{subsubsection_distance_oracle} мы строим для любых $\eps, \delta > 0$
    такую структуру данных размера $O(n^{1 + \delta})$, которая умеет отвечать на запрос за константное время.
    Для этого мы комбинируем факт наличия маленьких $\eps$-покрытий и оракул Торупа-Цвика~\cite{TZ05}.
    \subsubsection{Вложение метрик в $\ell_1$}
    Пусть $G = (V, E, w)$~--- взвешенный ненаправленный граф.
    Будем интересоваться, насколько хорошо можно приблизить метрику $d$ $\ell_1$-нормой.
    Следующая классическая теорема дает оптимальную оценку.
    \begin{theorem}[\cite{B85}]
        \label{theorem_bourgain}
        Существует отображение $f \colon V \to \ell_1^{O(\log^2 n)}$ такое, что для любых вершин 
        $v_1, v_2 \in V$ выполнены следующие неравенства:
        $$
            \frac{d(v_1, v_2)}{O(\log n)} \leq \|f(v_1) - f(v_2)\|_1 \leq d(v_1, v_2).
        $$
    \end{theorem}

    Но что если мы интересуемся только сохранением расстояний между вершинами $v_1, v_2 \in V$ такими, что
    $\dunw(v_1, v_2) \geq \eps n$? В разделе~\ref{subsubsection_metric_embeddings} мы докажем такую теорему.

    \begin{theorem}
        Существует отображение $f \colon V \to \ell_1^{O(\log n + \log^2 (1 / \eps))}$ такое, что для любых вершин 
        $v_1, v_2 \in V$ выполнено
        $$
            \frac{d(v_1, v_2)}{O(\log (1/\eps))} \leq \|f(v_1) - f(v_2)\|_1,
        $$
        и если $\dunw(v_1, v_2) \geq \eps n$, то дополнительно выполнено
        $$
            \|f(v_1) - f(v_2)\|_1 \leq d(v_1, v_2).
        $$
    \end{theorem}
    В работе~\cite{ABCDGKNS05} доказана более сильная версия этой теоремы, но наше доказательство непосредственно
    обобщается на
    специальные классы метрик, для которых теорему~\ref{theorem_bourgain} можно усилить (например, на метрики
    отрицательного типа~\cite{ALN05}).
    \subsection{Задача о системах пересадок}

    Задача о системах пересадок изучалась как с теоретической, так и с практической точки зрения.
    В работе~\cite{CHKZ02} приводится полиномиальный приближенный алгоритм, который строит $O(\log n)$-приближение
    для систем пересадок минимального размера.
    В работе~\cite{AFGW10} доказывается, что в графах ограниченной шоссейной размерности существуют системы пересадок
    почти линейного размера.
    В работе~\cite{ADGW11} показывается, что системы пересадок можно с успехом использовать для практического
    вычисления расстояний в дорожных сетях континентального размера.

    В разделе~\ref{section_hub_labels} мы получаем практически точную оценку на размер минимальной системы пересадок
    для булева куба $\zo^n$. Мы доказываем, что он равен $2.5^{(1 + o(1)) n}$.
    \section{Задача об $\eps$-покрытиях}
    \label{section_eps_covers}
    \subsection{Графы общего вида}
    \label{subsection_general_graphs}
    В этом разделе мы докажем две теоремы.
    Утверждение первой теоремы состоит в наличии $\eps$-покрытий маленького размера.
    \begin{theorem}
        \label{upper_bound}
        В любом взвешенном ненаправленном графе $G$ есть $\eps$-покрытие размера $O(\log(1 / \eps) / \eps)$ для
        любого $\eps > 0$. Более того, случайное множество вершин размера $O(\log(1 / \eps) / \eps)$ с высокой вероятностью
        является $\eps$-покрытием.
    \end{theorem}
    Возникает вопрос: можно ли улучшить оценку $O(\log(1 / \eps) / \eps)$ до $O(1 / \eps)$? Утверждение второй теоремы
    состоит в том, что это сделать нельзя.
    \begin{theorem}
        \label{lower_bound}
        Для любого положительного $C > 0$ существуют ненаправленный взвешенный граф $G$ и положительное $\eps > 0$
        такие, что любое $\eps$-покрытие в $G$ имеет размер по крайней мере $C / \eps$.
    \end{theorem}
    Теорема~\ref{upper_bound} доказывается с помощью понятия размерности Вапника\CC Червоненкиса. В
    разделе~\ref{subsubsection_vapnik_chervonenkis} мы напомним нужные нам для этого определения и утверждения.
    В разделе~\ref{subsubsection_upper_bound} мы докажем теорему~\ref{upper_bound}.
    В разделе~\ref{subsubsection_lower_bound} мы докажем теорему~\ref{lower_bound} с помощью
    плотностной версии теоремы Хейлса\CC Джуетта.
    \subsubsection{Размерность Вапника\CC Червоненкиса и $\eps$-сети}
    \label{subsubsection_vapnik_chervonenkis}

    Пусть $X$ --- конечное множество. Пусть $R \subseteq 2^X$ --- система подмножеств $X$.
    Следующие определения были даны в работе~\cite{VC71} для формулировки и доказательства равномерного варианта
    закона больших чисел.

    \begin{definition}
        Будем говорить, что подмножество $U \subseteq X$ \emph{разбивается} $R$, если
        для любого подмножества $V \subseteq U$ найдется элемент $W \in R$ такой,
        что $W \cap U = V$.
    \end{definition}
    \begin{definition}
        Будем говорить, что пара $(X, R)$ имеет размерность Вапника\CC Червоненкиса $d$, если максимальный размер 
        подмножества $X$, которое разбивается, равен $d$.
    \end{definition}

    Известно, что малость размерности Вапника\CC Червоненкиса является очень сильным свойством. Например, она гарантирует
    наличие маленьких так называемых $\varepsilon$-сетей.

    \begin{definition}
        Пусть $\mu$ --- вероятностная мера на $X$, а $0 < \varepsilon < 1$.
        Тогда подмножество $U \subseteq X$
        называется \emph{$\varepsilon$-сетью} тройки $(X, \mu, R)$, если для любого
        $V \in R$ такого, что $\mu(V) \geq \varepsilon$, $U$ пересекается с $V$.
    \end{definition}

    С помощью вероятностного метода~\cite{AS92} легко доказать следующую верхнюю оценку на размер
    $\varepsilon$-сети.

    \begin{theorem}
        \label{naive_epsilon_net}
        Для любой тройки $(X, \mu, R)$ существует $\varepsilon$-сеть размера
        $O(\log |R| / \varepsilon)$.
    \end{theorem}
    \begin{proof}
        Будем выбирать элементы $X$ независимо по мере $\mu$.
        Пусть мы выбрали $k$ элементов. Тогда для каждого $V \in R$ такого, что
        $\mu(V) \geq \varepsilon$, вероятность того, что никакой из выбранных элементов
        его не заденет, не превосходит $(1 - \varepsilon)^k$.

        Таким образом, вероятность того, что хотя бы какой-то элемент $R$ большой меры будет
        непокрыт, не превосходит
        $$
            |R| \cdot (1 - \varepsilon)^k.
        $$
        Видно, что можно взять $k = O(\log |R| / \varepsilon)$ так, чтобы эта вероятность не превосходила
        единицы.
    \end{proof}

    Однако, утверждение теоремы~\ref{naive_epsilon_net} можно существенно усилить, если у пары $(X, R)$
    маленькая размерность Вапника\CC Червоненкиса.

    \begin{theorem}[\cite{HW86}]
        \label{full_epsilon_net}
        Пусть у пары $(X, R)$ размерность Вапника\CC Червоненкиса равна $d$. Тогда для любой вероятностной меры $\mu$ на $X$\
        и для любого $0 < \varepsilon < 1$ существует $\varepsilon$-сеть тройки $(X, \mu, R)$ размера
        $n := O(d \cdot \log(1 / \varepsilon) / \varepsilon)$.
        Более того, если выбрать $n$ независимых элементов $X$ по мере $\mu$, то они с высокой вероятностью будут
        образовывать $\eps$-сеть.
    \end{theorem}
    \subsubsection{Верхняя оценка}
    \label{subsubsection_upper_bound}
    В этом разделе мы докажем теорему~\ref{upper_bound}.
    Для этого мы сначала пошевелим веса ребер $w$ так, чтобы все кратчайшие пути стали уникальными.

    Теперь мы воспользуемся наблюдением из~\cite{ADFGW11}. Для полноты мы приведем его вместе с доказательством.
    \begin{theorem}[\cite{ADFGW11}]
        \label{unique_vc_dimension}
        Пусть $G = (V, E, w)$~--- взвешенный ненаправленный граф, в котором все кратчайшие пути уникальны.
        Тогда размерность Вапника\CC Червоненкиса системы кратчайших путей $G$ (как множеств вершин)
        не превосходит двух.
    \end{theorem}
    \begin{proof}
        Нам надо доказать, что никакое множество из трех вершин не разбивается кратчайшими путями.
        Рассмотрим какое-то множество $\set{v_1, v_2, v_3}$ вершин.
        Действительно, если никакой кратчайший путь не проходит через все $\set{v_1, v_2, v_3}$, то все доказано.
        Пусть такой путь $P$ найдется. Не умаляя общности, можно считать, что вершина $v_2$ лежит на этом пути между
        $v_1$ и $v_3$. Но тогда в силу уникальности кратчайших путей нельзя получить множество $\set{v_1, v_3}$
        как ограничение какого-то кратчайшего пути на $\set{v_1, v_2, v_3}$.
    \end{proof}

    Остается заметить, что доказательство теоремы~\ref{upper_bound} получается непосредственной комбинацией
    теоремы~\ref{unique_vc_dimension} и теоремы~\ref{full_epsilon_net}.
    \subsubsection{Нижняя оценка}
    \label{subsubsection_lower_bound}
    В этом разделе мы докажем теорему~\ref{lower_bound}.
    Доказательство является простым сведением к глубокой теореме из аддитивной комбинаторики. Для ее формулировки нам
    понадобятся следующие определения.

    \begin{definition}
        Элементы $[k]^n$ будем называть \emph{точками}.
    \end{definition}

    \begin{definition}
        Будем называть подмножество $L \subseteq [k]^n$ \emph{комбинаторной прямой},
        если выполняются следующие условия:
        \begin{itemize}
            \item В $L$ ровно $k$ точек $l_1, l_2, \ldots, l_k$,
            \item Существует непустое множество $U \subseteq [n]$ такое, что ограничения всех точек 
            $L$ на $[n] \setminus U$ одинаковы, а у каждого $l_i$ на всех позициях $U$ стоит $i$.
        \end{itemize}
    \end{definition}

    Теперь мы готовы сформулировать плотностную версию теоремы Хейлса\CC Джуетта~\cite{P09}.
    \begin{theorem}
        \label{density_hales_jewett}
        Для любого натурального $k$ и вещественного $\delta > 0$ найдется натуральное $n_0$ такое, что для
        любого $n \geq n_0$ любое подмножество $[k]^n$ размера $\delta \cdot k^n$ содержит комбинаторную
        прямую.
    \end{theorem}

    Теперь все готово для доказательства теоремы~\ref{lower_bound}.

    Возьмем $k = \lceil 2C \rceil$ и $\delta = 1/2$. Тогда теорема~\ref{density_hales_jewett}
    дает нам какое-то $n_0$. Теперь построим граф $G$. Его вершинами будут точки из множества
    $[k]^{n_0}$.
    Опишем теперь, как будут выглядеть его ребра. Пусть $v = (v_1, v_2, \ldots, v_{n_0}) \in [k]^{n_0}$.
    Каждое непустое $U \subseteq [n_0]$ может давать до двух ребер, выходящих из $v$.
    Во-первых, если не все $v_i$ для $i \in U$ одинаковы, то ребер соответствющих $U$ из $v$
    не выходит.
    В противном случае рассмотрим два кортежа
    $u = (u_1, u_2, \ldots, u_{n_0})$ и $w = (w_1, w_2, \ldots, w_{n_0})$,
    которые задаются так:
    \begin{eqnarray*}
        u_i = \begin{cases}
            v_i - 1, & i \in U,\\
            v_i, & i \notin U.\\
        \end{cases}\\
        w_i = \begin{cases}
            v_i + 1, & i \in U,\\
            v_i, & i \notin U.\\
        \end{cases}
    \end{eqnarray*}
    Мы добавляем ребро из $v$, ведущее в $u$, если $u \in [k]^{n_0}$. Аналогично поступаем с $w$.
    Веса в $G$ положим единичными.

    Итак, граф $G$ готов.
    Во-первых, видно, что комбинаторным прямым в $[k]^{n_0}$ соответствуют (уникальные) кратчайшие пути в графе $G$.
    Возьмем $\varepsilon = 1 / k^{n_0-1}$. Тогда нам необходимо покрыть по крайней мере
    все комбинаторные прямые.
    Но из теоремы~\ref{density_hales_jewett} следует,
    что любое такое покрытие должно быть по крайней мере размера
    $k^{n_0} / 2$. В силу выбора $k$ теорема доказана.

    \subsection{Графы ограниченной древесной ширины}
    \label{subsection_bounded_treewidth}
    В этом разделе мы докажем, что у графов ограниченной древесной ширины есть $\eps$-покрытия размера $O(1 / \eps)$.
    Для этого сначала напомним определение древесной ширины.
    \begin{definition}
        \emph{Древесной декомпозицией ширины $k$} ненаправленного графа $G = (V, E)$ называется пара $(T, \varphi)$,
        где $T = (VT, ET)$~--- ненаправленное дерево, а $\varphi \colon VT \to 2^V$~--- отображение из вершин $T$
        в подмножества вершин $G$, которая удовлетворяет следующим требованиям:
        \begin{itemize}
            \item для любой вершины дерева $v \in VT$ размер $\varphi(v)$ не превосходит $k + 1$, 
            \item для любого ребра $e \in E$ найдется вершина дерева $v \in VT$ такая, что оба конца $e$ лежат в $\varphi(v)$,
            \item для любой вершины графа $v \in V$ множество вершин дерева $u \in VT$ таких, что $v \in \varphi(u)$
            образует связный подграф $T$.
        \end{itemize}
    \end{definition}
    \begin{definition}
        \emph{Древесной шириной} ненаправленного графа $G$ называется наименьшая ширина древесной декомпозиции $G$.
    \end{definition}
    Теперь сформулируем основную теорему этого раздела.
    \begin{theorem}
        \label{bounded_treewidth_eps_nets}
        Пусть $G = (V, E, w)$~--- взвешенный ненаправленный граф с древесной шириной $k$. Тогда у $G$
        существует $\eps$-покрытие размера $O(k^2 / \eps)$.
    \end{theorem}
    \begin{proof}
        Мы докажем более сильное утверждение:
        с помощью $O(k^2 / \eps)$ вершин можно покрыть \emph{все связные подмножества вершин $G$ размера $\eps n$}.

        Сначала установим истинность этого утверждения для деревьев.
        \begin{lemma}
            \label{tree_epsilon_net}
            Пусть $T = (VT, ET)$~--- ненаправленное дерево. Тогда найдется множество из $O(1 / \eps)$ вершин, которое
            покрывает все связные подмножества $T$ из $\eps n$ вершин.
        \end{lemma}
        \begin{proof}
            Будем строить искомое множество вершин жадным алгоритмом.
            Подвесим $T$ за какую-нибудь вершину $r \in VT$.         
            Теперь всем вершинам можно сопоставить \emph{глубину}: расстояние до $r$.
            Будем поддерживать список непокрытых связных множеств из $\eps n$ вершин.
            Каждому из этих множеств можно сопоставить его \emph{корень}: элемент множества с минимальной глубиной.
            На каждом шаге из непокрытых множеств будем выбирать множество с наиболее глубоким корнем и включать этот
            корень в ответ.
            Нетрудно убедиться, что множества, которые соответствуют двум корням, которые мы добавили в ответ,
            не пересекаются. Отсюда получаем оценку $O(1 / \eps)$ на размер ответа.
        \end{proof}

        Теперь перейдем к доказательству теоремы. Для этого нам потребуется простой факт про древесную декомпозицию.
        \begin{lemma}
            \label{moderate_decomposition}
            Пусть $G = (V, E)$~--- ненаправленный граф с древесной шириной $k$. Тогда у $G$ существует древесная
            декомпозиция ширины $k$ такая, что в дереве не более $n$ вершин.
        \end{lemma}
        \begin{proof}
            Пусть $(T, \varphi)$~--- древесная декомпозиция $G$ ширины $k$. Рассмотрим какой-то лист $v \in VT$.
            Если в $\varphi(v)$ есть вершина, которой нет ни в каком другом множестве вида $\varphi(\cdot)$, то,
            удаляя ее из графа и пользуясь предположением индукции, получаем требуемое.
            Если же в $\varphi(v)$ такой вершины нет, то понятно, что $\varphi(v) \subseteq \varphi(v')$, где $v'$~---
            сосед $v$ в $T$. Таким образом, $v$ можно безболезненно удалить из $T$.
        \end{proof}

        Рассмотрим древесную декомпозицию $(T, \varphi)$ ширины $k$. Рассмотрим для связного множества из $\eps n$
        вершин в $G$ его образ в $T$.
        Нетрудно понять, что это будет связное множество размера $\Omega(\eps n / k)$.
        По лемме~\ref{moderate_decomposition} можно считать, что размер $T$ не превосходит $n$ вершин. Пользуясь
        леммой~\ref{tree_epsilon_net}, получаем, что все эти образы можно покрыть $O(k / \eps)$ вершинами $T$.
        Дальше рассмотрев объединение всех множеств $\varphi(\cdot)$ для вершин покрытия, видим, что это объединение является
        искомым покрытием. Но его размер не превосходит $O(k^2 / \eps)$ по определению древесной ширины.
    \end{proof}
    \subsection{Приложения}
    \label{subsection_applications}
    \subsubsection{Оракул больших расстояний}
    \label{subsubsection_distance_oracle}
    В этом разделе мы будем строить оракул для больших расстояний.
    Пусть $G = (V, E)$~--- \emph{невзвешенный} ненаправленный граф.
    Пусть $0 < \eps, \delta < 1$~--- какие-то константы.

    Следующая теорема является простым следствием теоремы~\ref{upper_bound}.

    \begin{theorem}
        \label{naive_oracle}
        Существует оракул размера $O(n)$, который по вершинам $v_1, v_2 \in V$ за константное время сообщает некоторое
        число. При этом, если $d(v_1, v_2) \geq \eps n$, то это число равно $d(v_1, v_2)$.
    \end{theorem}
    \begin{proof}
        Пусть $U$~--- $\eps$-покрытие $G$ размера $O(\log(1 / \eps) / \eps) = O(1)$.
        Сохраним для каждой вершины $G$ расстояния до всех вершин из $U$.
        Когда нам поступает запрос $(v_1, v_2)$, мы сообщаем $\min_{u \in U} d(v_1, u) + d(u, v_2)$.

        Из определения $\eps$-покрытия видно, что если $d(v_1, v_2) \geq \eps n$, то 
        $$
            \min_{u \in U} d(v_1, u) + d(u, v_2) = d(v_1, v_2).
        $$
    \end{proof}

    Чтобы построить оракул, который отличает ситуацию $d(v_1, v_2) < \eps n$ от $d(v_1, v_2) \geq \eps n$,
    нам понадобится оракул Торупа-Цвика~\cite{TZ05}.

    \begin{theorem}[\cite{TZ05}]
        \label{thorup_zwick}
        Для любого натурального $k$ существует оракул размера $O(kn^{1 + 1/k})$, который за время $O(k)$
        умеет выдавать $(2k - 1)$-приближение к расстояниям, то есть, если на вход подаются две вершины $v_1, v_2$,
        то на выход выдается число $D$ такое, что
        $$
            d(v_1, v_2) \leq D \leq (2k - 1) \cdot d(v_1, v_2).
        $$
    \end{theorem}

    Теперь мы покажем, как можно скомбинировать теорему~\ref{naive_oracle} и теорему~\ref{thorup_zwick}.

    \begin{theorem}
        Существует оракул размера $O(n^{1 + \delta})$, который по двум вершинам $v_1, v_2$ сообщает одно из двух.
        Если $d(v_1, v_2) < \eps n$, то оракул сообщает об ошибке. Если $d(v_1, v_2) \geq \eps n$,
        то оракул сообщает точное значение $d(v_1, v_2)$.
    \end{theorem}
    \begin{proof}
        Построим оракул Торупа-Цвика (из теоремы~\ref{thorup_zwick}) для $k = \lceil 1 / \delta \rceil$.
        Его размер будет составлять $O(n^{1 + \delta})$. Обозначим $\eps' = \eps / (2k - 1)$.
        С помощью этого оракула мы можем отбраковать пары, для которых $d(v_1, v_2) < \eps' n$, при этом
        оставив пары, для которых $d(v_1, v_2) \geq \eps n$.

        Далее с помощью оракула из теоремы~\ref{naive_oracle}, построенного для $\eps'$, мы за константное время
        сможем найти точное значение $d(v_1, v_2)$.
    \end{proof}
    \subsubsection{Вложение метрик в $\ell_1$}
    \label{subsubsection_metric_embeddings}
    Пусть $G = (V, E, w)$~--- взвешенный ненаправленный граф. Он задает две метрики: $d$~--- кратчайшее расстояние
    между вершинами и $\dunw$~--- кратчайшее расстояние между вершинами в невзвешенной версии $G$.

    Мы хотим построить отображение $f \colon V \to \ell_1$ такое, что для любых вершин $v_1, v_2 \in V$ таких,
    что $\dunw(v_1, v_2) \geq \eps n$ выполняются неравенства
    $$
        \frac{d(v_1, v_2)}{D} \leq \|f(v_1) - f(v_2)\|_1 \leq d(v_1, v_2),
    $$
    где $D$~--- как можно меньшая величина.

    Если взять $\eps = 1/n$, то условие $\dunw(v_1, v_2) \geq \eps n$ становится тривиальным.
    Чтобы сформулировать известные результаты о вложении метрик для случая $\eps = 1/n$, нам понадобятся несколько
    определений.

    \begin{definition}
        \emph{Размерность удвоения} $d$~--- это минимальное натуральное $k$ такое, что любое подмножество $V$
        диаметра $\Delta$ можно покрыть $2^k$ подмножествами диаметра $\Delta / 2$.
    \end{definition}
    \begin{definition}
        Скажем, что метрика $d$ является \emph{метрикой отрицательного типа}, если $\sqrt{d}$ изометрически
        вкладывается в $\ell_2$.
    \end{definition}

    Теперь сформулируем известные результаты для случая $\eps = 1/n$.

    \begin{theorem}
        \label{embeddings}
        В случае $\eps = 1 / n$ верны следующие результаты.
        \begin{itemize}
            \item
            \cite{B85} Если $d$~--- произвольная метрика, Тогда
            $$
                D = O(\log n).
            $$
            \item
            \cite{GKL03} Если $d$~--- метрика с ограниченной размерностью удвоения, Тогда
            $$
                D = O\left(\sqrt{\log n}\right).
            $$
            \item
            \cite{ALN05} Если $d$~--- метрика отрицательного типа, Тогда
            $$
                D = O\left(\sqrt{\log n} \log \log n\right).
            $$
        \end{itemize}
    \end{theorem}

    Пользуясь теоремой~\ref{upper_bound}, мы докажем мета-теорему, которая позволит нам обобщить теорему~\ref{embeddings}
    на случай произвольного $\eps$, заменяя в оценках на $D$ все вхождения $n$ на $1 / \eps$.

    \begin{theorem}
        \label{subsampling}
        Пусть граф $G$ таков, что для любого $k$-элементного подмножества $V' \subseteq V$
        существует отображение $g \colon V' \to \ell_1^{t(k)}$ такое, что для любой пары вершин $v_1, v_2 \in V'$
        выполнены неравенства
        $$
            \frac{d(v_1, v_2)}{D(k)} \leq \|g(v_1) - g(v_2)\|_1 \leq d(v_1, v_2).
        $$
        Тогда для любого $\eps > 0$ существует отображение $f \colon V \to \ell_1^{O(\log n) + t(O(\log(1 / \eps) / \eps))}$
        такое, что для любой пары $v_1, v_2 \in V$ выполнено
        $$
            \frac{d(v_1, v_2)}{O(D(O(\log(1 / \eps) / \eps)))} \leq \|f(v_1) - f(v_2)\|_1,
        $$
        а для любой пары $v_1, v_2 \in V$ такой, что $\dunw(v_1, v_2) \geq \eps n$ выполнено
        $$
            \|f(v_1) - f(v_2)\|_1 \leq d(v_1, v_2).
        $$
    \end{theorem}
    \begin{proof}
        С помощью теоремы~\ref{upper_bound} выберем $\eps$-покрытие $U \subseteq V$ размера
        $m := O(\log(1 / \eps) / \eps)$.
        По условию теоремы существует вложение $g \colon U \to \ell_1^{t(m)}$ такое, что для любых $u_1, u_2 \in U$
        выполнено
        $$
            \frac{d(u_1, u_2)}{D(m)} \leq \|g(u_1) - g(u_2)\|_1 \leq d(u_1, u_2).
        $$
        Теперь продолжим $g$ на все $V$, пока не заботясь о размерности образа.
        Для этого обозначим $p(v)$ для $v \in V$ ближайшую к $v$ в смысле $d$ вершину из $U$.
        Обозначим $e(v)$ для $v \in V$ свежий базисный вектор из $\ell_1$.
        Продолжение $g$ будет устроено так:
        $$
            f(v) := \frac{1}{3} \cdot (g(p(v)) + e(v) \cdot d(v, p(v))).
        $$
        Пусть $v_1, v_2 \in V$. Оценим $\|f(v_1) - f(v_2)\|_1$ снизу.
        \begin{eqnarray*}
            \|f(v_1) - f(v_2)\|_1 = \frac{1}{3} \cdot (d(v_1, p(v_1)) + d(v_2, p(v_2)) + \|g(p(v_1)) - g(p(v_2))\|_1)
            \geq\\\geq \frac{1}{3} \cdot \left(d(v_1, p(v_1)) + d(v_2, p(v_2)) + \frac{d(p(v_1), p(v_2))}{D(m)}\right)
            \geq\\\geq \frac{1}{3} \cdot \frac{d(v_1, p(v_1)) + d(v_2, p(v_2)) + d(p(v_1), p(v_2))}{D(m)}
            \geq \frac{d(v_1, v_2)}{3 \cdot D(m)}
        \end{eqnarray*}
        Пусть теперь $v_1, v_2 \in V$ такие, что $\dunw(v_1, v_2) \geq \eps n$.
        Тогда по определению $\eps$-покрытия найдется $u \in U$ такая, что $d(v_1, v_2) = d(v_1, u) + d(u, v_2)$.

        Оценим $\|f(v_1) - f(v_2)\|_1$ сверху.
        \begin{eqnarray*}
            \|f(v_1) - f(v_2)\|_1 = \frac{1}{3} \cdot (d(v_1, p(v_1)) + d(v_2, p(v_2)) + \|g(p(v_1)) - g(p(v_2))\|_1)
            \leq\\\leq \frac{1}{3} \cdot (d(v_1, p(v_1)) + d(v_2, p(v_2)) + d(p(v_1), p(v_2)))
            \leq\\\leq \frac{1}{3} \cdot (2 \cdot(d(v_1, p(v_1)) + d(v_2, p(v_2))) + d(v_1, v_2))
            \leq\\\leq \frac{1}{3} \cdot (2 \cdot(d(v_1, u) + d(v_2, u)) + d(v_1, v_2)) \leq d(v_1, v_2).
        \end{eqnarray*}

        Таким образом, оба неравенства из условия теоремы доказаны. Осталось разобраться с размерностью образа.
        Образ построенного $f$ имеет размерность $t(m) + n$.
        Мы покажем, как можно уменьшить ее до $t(m) + O(\log n)$.

        Для этого посмотрим повнимательнее на наше построенное отображение $f$. Видно, что $f$ складывается из
        двух слагаемых: $g$ и так называемой \emph{звездчатой метрики}, то есть метрики вида $d(i, j) = a_i + a_j$,
        где $a_1, a_2, \ldots, a_n$~--- неотрицательные числа.
        Очевидно, что нам достаточно научиться вкладывать звездчатую метрику в $\ell_1^{O(\log n)}$
        с искажением $O(1)$.

        \begin{lemma}
            Пусть $a_1, a_2, \ldots, a_n$~--- неотрицательные числа. Рассмотрим метрику $d(i, j) = a_i + a_j$.
            Тогда существует отображение $f \colon [n] \to \ell_1^{O(\log n)}$ такое, что для всех $i, j \in [n]$
            $$
                \frac{d(i, j)}{3} \leq \|f(i) - f(j)\|_1 \leq d(i, j).
            $$
        \end{lemma}
        \begin{proof}
            Из теории кодирования известно, что существует подмножество $C \subseteq \zo^{l}$ размера $n$
            такое, что расстояние Хемминга между любыми двумя элементами $C$ не меньше $l / 3$, где $l = O(\log n)$.

            Будем строить отображение $f \colon [n] \to \ell_1^{2l}$. Для этого обозначим $\varphi \colon [n] \to C$
            какую-нибудь биекцию.

            Теперь положим для $i \in [n], j \in [l], k \in \zo$
            $$
                f(i)_{2j-k} = \begin{cases}
                    a_i, & k = \varphi(i)_j, \\
                    0, & k \ne \varphi(i)_j.
                \end{cases}
            $$
            Видно, что отображение $f$ удовлетворяет условию леммы.
        \end{proof}
    \end{proof}

    Теперь получим следствие из теоремы~\ref{embeddings} и теоремы~\ref{subsampling}.
    \begin{theorem}
        Для произвольного $\eps > 0$ верны следующие результаты.
        \begin{itemize}
            \item
            Если $d$~--- произвольная метрика, то 
            $$
                D = O(\log (1 / \eps)).
            $$
            \item
            Если $d$~--- метрика с ограниченной размерностью удвоения, то
            $$
                D = O\left(\sqrt{\log (1 / \eps)}\right).
            $$
            \item
            Если $d$~--- метрика отрицательного типа, то
            $$
                D = O\left(\sqrt{\log (1 / \eps)} \log \log (1 / \eps)\right).
            $$
        \end{itemize}
    \end{theorem}
    \section{Системы пересадок в булевом кубе}
    \label{section_hub_labels}
    В этом разделе мы покажем, что минимальный размер системы пересадок для булева куба $\zo^n$ равен $2.5^{(1+o(1))n}$.
    Мы будем отождествлять $\zo^n$ и подмножества $[n] = \set{1, 2, \ldots, n}$. Для вершин $i, j \in \zo^n$ обозначим $\Pc(i, j)$ множество вершин, которые лежат
    на кратчайших путях из $i$ в $j$. Обозначим $d(i, j)$ расстояние между вершинами $i$ и $j$.

    Обозначим минимальный размер
    системы пересадок $\mathbf{OPT}$.
    Составим целочисленную программу, решение которой равно $\mathbf{OPT}$.
    \begin{equation}
        \label{ilp}
        \begin{cases}
            x_{v,S} \in \zo & \forall \; v \in \zo^n, S \subseteq \zo^n, \\ 
            \sum_{\begin{smallmatrix}i, j \in S \\ v \in \Pc(i, j)\end{smallmatrix}} x_{v,S} \geq 1 & \forall \; i, j \in \zo^n, \\
            \sum_{v,S} |S| \cdot x_{v,S} \to \min.
        \end{cases}
    \end{equation}
    Рассмотрим следующую линейную релаксацию~(\ref{ilp}). Обозначим ее оптимальное решение $\mathbf{LP}$.
    \begin{equation}
        \label{lp}
        \begin{cases}
            x_{v,S} \geq 0 & \forall \; v \in \zo^n, S \subseteq \zo^n, \\ 
            \sum_{\begin{smallmatrix}i, j \in S \\ v \in \Pc(i, j)\end{smallmatrix}} x_{v,S} \geq 1 & \forall \; i, j \in \zo^n, \\
            \sum_{v,S} \abs{S} \cdot x_{v,S} \to \min.
        \end{cases}
    \end{equation}
    Очевидно, что $\mathbf{OPT} \geq \mathbf{LP}$. Как известно, $\mathbf{OPT} \leq O(n) \cdot \mathbf{LP}$
    (см., например,~\cite{V04}).

    Рассмотрим теперь программу, которая является двойственной к~(\ref{lp}).
    Очевидно, что ее оптимальное решение тоже равно $\mathbf{LP}$.
    \begin{equation}
        \label{dual_lp}
        \begin{cases}
            y_{i,j} \geq 0 & \forall \; i, j \in \zo^n, \\ 
            \sum_{\begin{smallmatrix}i, j \in S \\ v \in \Pc(i, j)\end{smallmatrix}} y_{i,j} \leq \abs{S} & \forall \; v \in \zo^n, S \subseteq \zo^n,  \\
            \sum_{i,j} y_{i,j} \to \max.
        \end{cases}
    \end{equation}
    Пояснение: здесь и далее в этом разделе индексы $i, j$ пробегают \emph{неупорядоченные} пары вершин. То есть,
    всего в двойственной программе $2^n \cdot (2^n + 1) / 2$ переменных.
    Теперь усилим~(\ref{dual_lp}): а именно, потребуем, чтобы значения переменных $y_{i,j}$ зависели только от расстояния между $i$ и $j$ (назовем такие
    решения <<регулярными>>).
    Таким образом, у нас теперь будут переменные $\tilde{y}_0, \tilde{y}_1, \ldots, \tilde{y}_n$.
    Обозначим $N_d$ количество пар вершин, расстояние между которыми равно $d$. Тогда программа записывается так:
    \begin{equation}
        \label{regular_dual_lp}
        \begin{cases}
            \tilde{y}_d \geq 0 & \forall \; 0 \leq d \leq n, \\
            \sum_{\begin{smallmatrix}i, j \in S \\ 0^n \in \Pc(i, j)\end{smallmatrix}} \tilde{y}_{d(i, j)} \leq \abs{S} & \forall \; S \subseteq \zo^n, \\
            \sum_{d} N_d \cdot \tilde{y}_d \to \max.
        \end{cases}
    \end{equation}
    Мы оставили только ограничения с $v = 0^n$, потому что другие ограничения не дают ничего нового, так как нас теперь интересуют только длины путей.
    Обозначим оптимальное решение этой программы $\mathbf{RegularLP}$.
    Очевидно, что $\mathbf{RegularLP} \leq \mathbf{LP}$.
    Однако, верно и обратное неравенство.
    \begin{theorem}
        $$
            \mathbf{LP} \leq \mathbf{RegularLP}
        $$
    \end{theorem}
    \begin{proof}
        Пусть $y_{i,j}$ --- решение~(\ref{dual_lp}). Мы хотим изготовить решение~(\ref{regular_dual_lp}) с не меньшим значением целевой функции.
        Положим
        $$
            \tilde{y}_d := \Exp{d(i, j) = d}{y_{i,j}}.
        $$
        Очевидно, что
        $$
            \sum_{i,j}y_{i,j} = \sum_d N_d \tilde{y}_d,
        $$
        таким образом, остается доказать, что $\tilde{y}$ удовлетворяет
        всем ограничениям~(\ref{regular_dual_lp}).
        Возьмем какое-то $S \subseteq \zo^n$. Мы хотим проверить, что
        \begin{equation}
            \label{regular_constraint}
            \sum_{\begin{smallmatrix}i, j \in S \\ 0^n \in \Pc(i, j)\end{smallmatrix}}
            \tilde{y}_{d(i, j)} \leq \abs{S}.
        \end{equation}
        Так как $y$~--- решение~(\ref{dual_lp}), то 
        $$
            \sum_{\begin{smallmatrix}i, j \in S \\ 0^n \in \Pc(i, j)\end{smallmatrix}}
            y_{i, j} \leq \abs{S}.
        $$
        Рассмотрим отображение $A \colon \zo^n \to \zo^n$, которое является композицией отображения вида $x \mapsto x \oplus z$, где $z \in \zo^n$~--- случайный вектор,
        и случайной перестановки координат.

        Видно, во-первых, что $A$~--- биекция, во-вторых, $A$ сохраняет
        все расстояния,
        а, в-третьих, если для расстояние между какими-то вершинами $i, j \in \zo^n$
        равно $d$, то пара $(A(i), A(j))$ распределена равномерно среди всех пар
        вершин на расстоянии $d$.

        Рассмотрим следующую случайную величину:
        $$
            X = \sum_{\begin{smallmatrix}
                i, j \in A(S) \\
                A(0^n) \in \Pc(i, j)
            \end{smallmatrix}} y_{i,j}.
        $$
        С одной стороны, так как $A$~--- биекция, а $y$~--- решение~(\ref{dual_lp}),
        то $\Exp{A}{X} \leq \abs{S}$.
        С другой стороны,
        \begin{eqnarray*}
            \Exp{A}{X} = \Exp{A}{
            \sum_{\begin{smallmatrix}
                i, j \in A(S) \\
                A(0^n) \in \Pc(i, j)
            \end{smallmatrix}} y_{i,j}
            } =  \Exp{A}{
            \sum_{\begin{smallmatrix}
                i, j \in S \\
                0^n \in \Pc(i, j)
            \end{smallmatrix}} y_{A(i),A(j)}
            } =\\= \sum_{\begin{smallmatrix}i, j \in S \\
                0^n \in \Pc(i, j)\end{smallmatrix}} \Exp{A}{y_{A(i),A(j)}} = 
                \sum_{\begin{smallmatrix}i,j \in S \\ 0^n \in \Pc(i, j)
                    \end{smallmatrix}} \tilde{y}_{d(i,j)}.
        \end{eqnarray*}
        В последнем переходе мы пользуемся тем, что пара $(A(i), A(j))$
        распределена равномерно среди всех пар на расстоянии $d(i, j)$.
        Таким образом, (\ref{regular_constraint}) доказано.
    \end{proof}

    Таким образом, получаем, что
    $$
        \mathbf{RegularLP} \leq \mathbf{OPT} \leq O(n) \cdot \mathbf{RegularLP}.
    $$

    Мы докажем, что $\mathbf{RegularLP} = 2.5^{(1+o(1))n}$.

    Обозначим $\Oc$ политоп задачи~(\ref{regular_dual_lp}).
    Обозначим 
    $$
        \tilde{y}_d^* := \max_{\tilde{y} \in \Oc} \tilde{y}_d.
    $$
    Поясним: для каждого $d$ мы выбрали $\tilde{y}_d^*$~--- наибольшее из всех допустимых значений $\tilde{y}_d$.  Очевидно, что
    $$
        \max_d (N_d \cdot \tilde{y}_d^*) \leq \mathbf{RegularLP} \leq O(n) \cdot \max_d (N_d \cdot \tilde{y}_d^*).
    $$
    Поэтому остается лишь доказать, что $\max_d (N_d \cdot \tilde{y}_d^*) = 2.5^{(1 + o(1)) n}$.
    Очевидно верна следующая формула для $N_d$:
    $$
        N_d = \begin{cases}
            2^n & d = 0 \\
            2^{n-1} \cdot \binom{n}{d} & d > 0.
        \end{cases}
    $$

    Нам потребуется лемма, которая может иметь и самостоятельный интерес:

    \begin{lemma}
        \label{lm:regular}
        В регулярном графе плотность любого подграфа не превосходит плотности всего графа.
        В двудольном графе, в котором в каждой доле вершины имеют одинаковую степень,
        плотность любого подграфа не превосходит плотности всего графа.
    \end{lemma}
    \begin{proof}
        Оценив степень каждой вершины подграфа степенью в исходном графе, получим верхнюю оценку на число рёбер в подграфе, а из этого~---
        что плотность подграфа не превосходит плотности всего графа.
        
        Докажем теперь утверждение про двудольные графы.
        Действительно, пусть в одной доле $p$ вершин, а в другой~--- $q$ вершин. Пусть в доле с $p$ вершинами у всех вершин степень $d$.
        Рассмотрим подграф такой, что в нем $u$ вершин из первой доли и $v$ вершин из второй.
        Если в обеих долях подграфа есть вершины не максимальной степени (меньше $d$ и $pd / q$, соответственно),
        то будем добавлять ребра между такими вершинами, пока такие пары остаются.
        Не умаляя общности, считаем, что все вершины в первой доле подграфа имеют степень $d$.
        Так как все степени подграфа во второй доле не превосходят $pd / q$, то имеем $ud \leq vpd / q$, то есть $uq \leq vp$.
        Отсюда получаем, что $ud / (u + v) \leq pd / (p + q)$, но это значит, что подграф не более плотный, чем целый граф.
    \end{proof}


    Теперь явно вычислим $\tilde{y}_d^*$.
   
    \begin{lemma}
        $$
            \tilde{y}_d^* = \begin{cases}
                1 & d = 0 \\
                2 / \binom{n - k}{k} & d = 2k, k > 0 \\
                \left(\binom{n}{k} + \binom{n}{k + 1}\right) / \left(\binom{n}{k} \cdot \binom{n - k}{k + 1}\right) & d = 2k + 1.
            \end{cases}
        $$
    \end{lemma}
    \begin{proof}
        Если отождествить $\zo^n$ с подмножествами $[n]$, то можно заметить, что условие $0^n \in \Pc(i, j)$ эквивалентно условию непересекаемости соответствующих множеств.

        Сперва докажем нижние оценки.
        Для этого рассмотрим граф, вершинами которого будут подмножества $[n]$, а ребра будут соединять подмножества,
        которые не пересекаются, и сумма размеров которых составляет $d$.
        Для доказательства нижних оценок достаточно показать, что подграфы,
        индуцированные $S := \setst{A \subseteq [n]}{\abs{A} = k}$ для $d = 2k$ и $S := \setst{A \subseteq [n]}{k \leq \abs{A} \leq k + 1}$
        для $d = 2k + 1$, являются подграфами наибольшей плотности в нашем графе.

        Для этого повнимательнее посмотрим на структуру графа. Его компоненты связности --- это множества
        $V_l := \setst{A \subseteq [n]}{\abs{A} = l} \cup \setst{A \subseteq [n]}{\abs{A} = d - l}$.
        По лемме~\ref{lm:regular} наиболее плотные подграфы $V_l$~--- это сами $V_l$. А из леммы~\ref{lm:middle} следует, что
        среди всех $V_l$ наибольшей плотностью обладает компонента $V_{\lfloor d / 2\rfloor}$.

        Соответствующие верхние оценки очевидны. Действительно, для этого достаточно посмотреть на ограничения, задаваемые компонентами $V_{\lfloor d / 2\rfloor}$.

    \end{proof}

    Итак, нам остается понять, каков максимум выражения
    $$
        N_d \cdot \tilde{y}_d^* = 2^n \cdot \begin{cases}
            \binom{n}{2k} / \binom{n - k}{k} & d = 2k \\
            \binom{n}{2k + 1} \cdot \left(\binom{n}{k} + \binom{n}{k + 1}\right) / \left(2 \cdot \binom{n}{k} \cdot \binom{n - k}{k + 1}\right) & d = 2k + 1.
        \end{cases}
    $$
    Несложно проверить, что в обоих случаях максимум достигается на $k = (1 + o(1)) n / 5$. Воспользовавшись формулой $\binom{n}{\alpha n}=2^{n(H(\alpha)+o(1))}$, где
    $$
        H(\alpha) = -\alpha\log_2(\alpha) -(1-\alpha)\log_2(1-\alpha),
    $$ получаем, что $\max_d N_d \cdot \tilde{y}_d^* = 2.5^{(1+o(1))n}$.


    \begin{lemma}
        \label{lm:middle}
        Максимум выражения
        $$
            \binom{n}{l}\cdot\binom{n-l}{d-l} / \left(\binom{n}{l} + \binom{n}{d-l}\right)
        $$
         при фиксированных $n$ и $d$ достигается при $l = \lfloor d/2 \rfloor$.
    \end{lemma}
    \begin{proof}
        Обозначим $h = d/2 - l$ и распишем биномиальные коеффициенты. Получим
        $$
            \frac{1}{(n-d)!}\cdot
            \frac{1}{\frac{(d/2+h)!}{(n-(d/2-h))!} + \frac{(d/2-h)!}{(n-(d/2+h))!}}.
        $$
        Мы хотим минимизировать знаменатель второй дроби. Обозначим его слагаемые $t$ и $s$ соответственно.
        При увеличении $h$ на 1 первое слагаемое в нём увеличивается в $\alpha = (d/2+h)(n-(d/2-h))$ раз,
        а второе~--- уменьшается в $\beta = (d/2-h)(n-(d/2+h))$ раз. Ясно, что $\alpha \ge \beta$.

        Докажем, что если $t\ge s\ge 0$, и $\alpha > \beta \ge 1$ то $\alpha t + \frac1\beta s\ge t+s$.
        Действительно, хотим показать, что $(\alpha - 1)t\ge(1-\frac1\beta)s$. Достаточно, чтобы выполнялось $(\alpha - 1)\ge(1-\frac1\beta)$,
        а это верно, поскольку $2 \le \alpha + \frac1\alpha \le \alpha + \frac1\beta$.

        Мы показали, что при увеличении $h$ на 1 знаменатель увеличивается.
        При минимальном $h$ имеем либо $t = s = \frac{p!}{(n-p)!}$, если $d = 2k$,
        либо $t = \frac{(\lfloor d/2 \rfloor + 1)!}{(n - \lfloor d/2 \rfloor)!}$,
        $s = \frac{\lfloor d/2 \rfloor!}{(n-(\lfloor d/2 \rfloor + 1))!}$ (и $t > s$),
        если $d = 2k + 1$.
        Следовательно, минимум знаменателя достигается при минимальном $h$, т.е. при $l = \lfloor d/2 \rfloor$.
    \end{proof}
    \section{Открытые вопросы}
    В заключение мы сформулируем несколько открытых вопросов.
    \begin{itemize}
        \item
        Теорема~\ref{upper_bound} дает $\eps$-покрытия размера $O(\log(1 / \eps) / \eps)$, теорема~\ref{lower_bound}
        показывает, что эту оценку нельзя улучшить до $O(1 / \eps)$. В то же время,
        теорема~\ref{bounded_treewidth_eps_nets} дает
        $\eps$-покрытия размера $O(1 / \eps)$ для графов ограниченной древесной ширины.

        Для каких естественных классов графов верна верхняя оценка $O(1 / \eps)$ на размеры $\eps$-покрытий?
        Верна ли линейная верхняя оценка для планарных графов?
        Для графов, которые не содержат фиксированный граф как минор?
        \item
        Можно ли избавиться в теореме~\ref{subsampling} от зависимости от $n$ в размерности образа?
        \item
        В разделе~\ref{section_hub_labels} мы доказали существование системы пересадок размера $2.5^{(1+o(1))n}$ для
        булева куба, не строив ее явно.
        Можно ли построить явную систему пересадок такого размера?
    \end{itemize}
    \bibliographystyle{alpha}
    \bibliography{../bibtex/ir}
\end{document}
